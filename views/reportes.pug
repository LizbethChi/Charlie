extends ./layout/index.pug

block mainContent
  // ===========================
  // ENCABEZADO
  // ===========================
  header(class="mb-8 flex flex-wrap justify-between items-center gap-4")
    h1(class="text-2xl font-bold text-white") Reportes del sistema
    div(class="flex gap-3")
      button(class="bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded-lg transition-all") Exportar PDF
      button(class="bg-green-600 hover:bg-green-500 text-white px-4 py-2 rounded-lg transition-all") Exportar Excel
      button(class="bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-lg transition-all") Exportar CSV

  // ===========================
  // FILTROS
  // ===========================
  section(class="bg-gray-900/40 border border-gray-700 p-6 rounded-2xl shadow-md mb-8")
    h2(class="text-lg font-semibold text-gray-200 mb-4") Filtros de búsqueda

    form(class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4")
      div
        label(class="text-gray-400 text-sm") Fecha inicio
        input(type="date" class="w-full mt-1 p-2 rounded-lg bg-gray-800 text-gray-200 border border-gray-700")

      div
        label(class="text-gray-400 text-sm") Fecha final
        input(type="date" class="w-full mt-1 p-2 rounded-lg bg-gray-800 text-gray-200 border border-gray-700")

      div
        label(class="text-gray-400 text-sm") Tipo de alerta
        select(class="w-full mt-1 p-2 rounded-lg bg-gray-800 text-gray-200 border border-gray-700")
          option(value="all") Todas
          option(value="critica") Distracción crítica
          option(value="leve") Distracción leve
          option(value="inactividad") Inactividad
          option(value="somnolencia") Somnolencia

      div
        label(class="text-gray-400 text-sm") Operador
        select(class="w-full mt-1 p-2 rounded-lg bg-gray-800 text-gray-200 border border-gray-700")
          option(value="all") Todos
          option Carlos Martínez
          option José López
          option Ana Rodríguez

    button(class="mt-4 bg-primary hover:bg-blue-400 text-white px-4 py-2 rounded-lg transition-all") Buscar

  // ===========================
  // TARJETAS RESUMEN (DINÁMICAS)
  // ===========================
  section(class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8")

    div(class="bg-card-dark p-4 rounded-2xl shadow-md")
      h2(class="text-sm text-gray-400") Total de alertas
      p#totalAlertas(class="text-3xl font-bold text-red-400 mt-1") 0

    div(class="bg-card-dark p-4 rounded-2xl shadow-md")
      h2(class="text-sm text-gray-400") Operador con más alertas
      p#operadorMasAlertas(class="text-xl font-bold text-white mt-1") —

    div(class="bg-card-dark p-4 rounded-2xl shadow-md")
      h2(class="text-sm text-gray-400") Máquina más activa
      p#maquinaActiva(class="text-xl font-bold text-blue-400 mt-1") —

    div(class="bg-card-dark p-4 rounded-2xl shadow-md")
      h2(class="text-sm text-gray-400") % Alertas críticas
      p#porcentajeCriticas(class="text-3xl font-bold text-yellow-400 mt-1") 0%

  // ===========================
  // GRÁFICAS
  // ===========================
  section(class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-10")

    // DISTRIBUCIÓN POR TIPO
    div(class="bg-card-dark p-6 rounded-2xl shadow-md h-[300px] flex flex-col")
      h2(class="text-lg font-semibold mb-3 text-gray-200") Distribución por tipo de alerta
      
      // Contenedor del canvas
      div(class="flex-1 relative")
        canvas#chartTipoAlertas(class="absolute inset-0 w-full h-full")

    // ALERTAS POR HORA
    div(class="bg-card-dark p-6 rounded-2xl shadow-md h-[300px] flex flex-col")
      h2(class="text-lg font-semibold mb-3 text-gray-200") Alertas por hora del día

      div(class="flex-1 relative")
        canvas#chartHoras(class="absolute inset-0 w-full h-full")


  // ===========================
  // TABLA DINÁMICA
  // ===========================
  
  section(class="bg-card-dark p-6 rounded-2xl shadow-md mb-16")
    h2(class="text-xl font-bold mb-4") Historial de reportes

    table(class="w-full text-sm text-gray-300")
      thead(class="text-gray-400 border-b border-gray-700")
        tr
          th(class="text-left py-2") Fecha
          th(class="text-left py-2") Operador
          th(class="text-left py-2") Máquina
          th(class="text-left py-2") Tipo
          th(class="text-left py-2") Acción

      tbody#tablaReportes
        // JS insertará las filas automáticamente

  script(src="https://cdn.jsdelivr.net/npm/chart.js")
  script(src="/js/reportes.js")
